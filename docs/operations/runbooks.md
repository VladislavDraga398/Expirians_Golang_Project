# üìñ Runbooks

> Runbooks –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏

**–í–µ—Ä—Å–∏—è:** v2.0 | **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-10-01 | **–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–æ

---

## üéØ TL;DR
- –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ–º, –∑–∞—Ç–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä—É–µ–º; –ª–æ–≥–∏—Ä—É–µ–º –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è.
- –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏: —Ä–æ—Å—Ç DLQ, –≤—Å–ø–ª–µ—Å–∫–∏ p95, –≤—Å–ø–ª–µ—Å–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏, –∑–∞–≤–∏—Å—à–∏–µ —Å–∞–≥–∏, –¥–≤–æ–π–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤.

## –ü—Ä–∏–Ω—Ü–∏–ø—ã
- –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É, –∑–∞—Ç–µ–º –∏—â–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –ø—Ä–∏—á–∏–Ω—É.
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤.

## –†–æ—Å—Ç DLQ / –±—ç–∫–ª–æ–≥ outbox
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `outbox_pending_records`, `outbox_oldest_pending_age_seconds`, `outbox_dlq_total`.
  - –°–æ—Å—Ç–æ—è–Ω–∏–µ –±—Ä–æ–∫–µ—Ä–∞, –ª–∞–≥–∏ –∫–æ–Ω—Å—É–º–µ—Ä–æ–≤, –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
  - –õ–æ–≥–∏ publisher –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–∏—á–∏–Ω –æ—à–∏–±–æ–∫.
- –î–µ–π—Å—Ç–≤–∏—è
  - –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Ä–∫–µ—Ä—ã/–±–∞—Ç—á–∏ publisher.
  - –ï—Å–ª–∏ –±—Ä–æ–∫–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî —ç—Å–∫–∞–ª–∞—Ü–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ; –ø—É–±–ª–∏–∫–∞—Ü–∏—é –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.
  - –†–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ DLQ –±–∞—Ç—á–∞–º–∏; –≤–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Å—É–º–µ—Ä–∞—Ö.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –°—Ç–∞—Ä–µ–π—à–∏–π pending < 2 –º–∏–Ω, DLQ —Å—Ç–∞–±–∏–ª–µ–Ω, error rate –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞.
- –†–∏—Å–∫–∏
  - –î—É–±–ª–∏–∫–∞—Ç—ã ‚Äî –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –æ–±—è–∑–∞–Ω—ã –±—ã—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã.

## –í—Å–ø–ª–µ—Å–∫–∏ p95 –∑–∞–¥–µ—Ä–∂–∫–∏ API
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
  - –°—Ä–∞–≤–Ω–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ —Ç—Ä–µ–π—Å–∞—Ö.
  - –ù–∞—Å—ã—â–µ–Ω–∏–µ –ø—É–ª–∞ –ë–î/–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.
  - –õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Inventory/Payment), —Å–æ—Å—Ç–æ—è–Ω–∏–µ CB.
- –î–µ–π—Å—Ç–≤–∏—è
  - –í–∫–ª—é—á–∏—Ç—å rate limiting; –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å circuit breaker.
  - –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å; –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—É–ª –ë–î; –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ä—è—á–∏–µ –∑–∞–ø—Ä–æ—Å—ã/–∏–Ω–¥–µ–∫—Å—ã.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - p95 –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö SLO 10‚Äì15 –º–∏–Ω; –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π error rate.

## –í—Å–ø–ª–µ—Å–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
  - `idempotency_conflicts_total` –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º.
  - –õ–æ–≥–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∫–ª—é—á–æ–º –∏ —Ä–∞–∑–Ω—ã–º `request_hash`.
- –î–µ–π—Å—Ç–≤–∏—è
  - –õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å ¬´—à—É–º–Ω—ã—Ö¬ª –∫–ª–∏–µ–Ω—Ç–æ–≤; –¥–æ–Ω–µ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π.
  - –ü–æ–¥—Å—Ç—Ä–æ–∏—Ç—å TTL –ø—Ä–∏ –≤—ã—è–≤–ª–µ–Ω–Ω–æ–º –ø–∞—Ç—Ç–µ—Ä–Ω–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –∫ –±–∞–∑–æ–≤–æ–º—É —É—Ä–æ–≤–Ω—é; —á–∞—Å—Ç–æ—Ç–∞ 409/AlreadyExists –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–ª–∞—Å—å.

## –ó–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏–µ —Å–∞–≥ (–¥–æ–ª–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
  - –î–∞—à–±–æ—Ä–¥—ã —Å–∞–≥: –¥–æ–ª–≥–∏–µ —à–∞–≥–∏; –∫–∞–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ç–æ—Ä–º–æ–∑–∏—Ç.
  - –°—Ç–∞—Ç—É—Å –≤–æ—Ä–∫–µ—Ä–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ `order_id`.
- –î–µ–π—Å—Ç–≤–∏—è
  - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Ä–∫–µ—Ä; —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ä–µ-—ç–Ω—Ç–µ—Ä–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏.
  - –í–∫–ª—é—á–∏—Ç—å watchdog –¥–ª—è –¥–æ–ª–≥–∏—Ö —à–∞–≥–æ–≤.
  - –†—É—á–Ω–æ–π force cancel/confirm —Å –∞—É–¥–∏—Ç–æ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –°–Ω–∏–∂–µ–Ω–∏–µ —á–∏—Å–ª–∞ –¥–æ–ª–≥–∏—Ö —Å–∞–≥; –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∞–Ω–∏–π.

## ¬´–î–≤–æ–π–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç¬ª (–¥–≤–æ–π–Ω–æ–π refund/confirm)
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
  - –°–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏/—Å–æ–±—ã—Ç–∏—è –∏ –∫–ª—é—á–∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏.
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î –Ω–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã.
- –î–µ–π—Å—Ç–≤–∏—è
  - –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –≤–æ—Ä–∫–µ—Ä/—à–∞–≥.
  - Reconcile —Å –ø–ª–∞—Ç—ë–∂–Ω—ã–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º; –≤—Ä—É—á–Ω—É—é –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –∞—É–¥–∏—Ç–æ–º.
  - –£–∂–µ—Å—Ç–æ—á–∏—Ç—å –∫–ª—é—á–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—é –∫–æ–Ω—Å—É–º–µ—Ä–æ–≤.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ; –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã.

## –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–Ω–µ—à–Ω–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (Inventory/Payment)
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
  - –û—à–∏–±–∫–∏ gRPC-–∫–ª–∏–µ–Ω—Ç–∞; —Å–æ—Å—Ç–æ—è–Ω–∏–µ CB; —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- –î–µ–π—Å—Ç–≤–∏—è
  - –†–µ–∂–∏–º –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏: —Å—Ç–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ—á–µ—Ä–µ–¥—å; —É–≤–µ–¥–æ–º–∏—Ç—å –æ –∑–∞–¥–µ—Ä–∂–∫–∞—Ö.
  - –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Ä–µ—Ç—Ä–∞–µ–≤; —É–≤–µ–¥–æ–º–∏—Ç—å —Å—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä–æ–≤.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –ü—Ä–æ–≤–∞–π–¥–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω; error rate –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–ª—Å—è.

## –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- –î–µ–π—Å—Ç–≤–∏—è
  - –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Ä–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏/–ø–∞—Ä–æ–ª–∏.
  - –ê—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–∞ –≤ —Å–µ–∫—Ä–µ—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–µ; –ø–æ–∏—Å–∫ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π.
  - –û—Ç–æ–∑–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã; –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –ø–æ –ø–æ–ª–∏—Ç–∏–∫–µ –ò–ë.
- –ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –ù–æ–≤—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω—ã; –∞–Ω–æ–º–∞–ª–∏–π –¥–æ—Å—Ç—É–ø–∞ –Ω–µ—Ç.

