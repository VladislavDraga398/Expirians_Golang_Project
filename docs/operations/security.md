# üîê Security

> –°—Ç—Ä–∞—Ç–µ–≥–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è OMS: –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

**–í–µ—Ä—Å–∏—è:** v2.0 | **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-10-01 | **–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–æ

---

## üéØ TL;DR

- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** mTLS –≤–Ω—É—Ç—Ä–∏, JWT/OIDC (–∏–ª–∏ API Key –¥–ª—è MVP) —Å–Ω–∞—Ä—É–∂–∏
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** RBAC, –ø—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π, –∞—É–¥–∏—Ç –∞–¥–º–∏–Ω-–¥–µ–π—Å—Ç–≤–∏–π
- **–°–µ–∫—Ä–µ—Ç—ã:** Secret Manager + —Ä–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è
- **–ó–∞—â–∏—Ç–∞:** rate limiting, –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–±—É—Ñ–æ–º, —Ä–∞–∑–º–µ—Ä payload, masking PII
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** authn/z –æ—à–∏–±–∫–∏, rate limit, –¥–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–∞–º

---

## üìñ –¶–µ–ª–∏

–û–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—Ç–µ—á–∫–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π.

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π gRPC: mTLS –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏; —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SPIFFE/SPIRE –∏–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç).
- –í–Ω–µ—à–Ω–∏–π API (–µ—Å–ª–∏ –µ—Å—Ç—å): JWT/OIDC bearer-—Ç–æ–∫–µ–Ω—ã; –¥–ª—è MVP –¥–æ–ø—É—Å—Ç–∏–º API Key –¥–ª—è m2m.

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (RBAC)
- –†–æ–ª–∏: `service`, `operator`, `viewer`, `auditor`.
- –ü–æ–ª–∏—Ç–∏–∫–∏: –Ω–∞ —É—Ä–æ–≤–Ω–µ RPC-–º–µ—Ç–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `RefundOrder` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω), –∞–¥–º–∏–Ω-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Ä–æ–ª–∏.
- –ü—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î/–±—Ä–æ–∫–µ—Ä—É –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤.

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Secret Manager (Vault/Cloud). –ù–µ —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ/–ª–æ–≥–∞—Ö.
- –†–æ—Ç–∞—Ü–∏—è: –ø–ª–∞–Ω–æ–≤–∞—è –∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è. –ê—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ–∫—Ä–µ—Ç–∞–º.

## –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- TLS 1.2+ –¥–ª—è gRPC-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤; –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ mTLS –¥–ª—è east-west —Ç—Ä–∞—Ñ–∏–∫–∞.
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∏—Ñ—Ä–æ—Åuites; –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–∞–±—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.

## –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- –ü—Ä–æ—Ç–æ–±—É—Ñ-—Å—Ö–µ–º—ã + –¥–æ–ø. –±–∏–∑–Ω–µ—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–¥–∏–∞–ø–∞–∑–æ–Ω—ã qty, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞–ª—é—Ç—ã, –ø—Ä–µ–¥–µ–ª—ã —Å—É–º–º).
- Rate limiting –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–º –≤—Ö–æ–¥–µ –∏/–∏–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–∏—Å–∞.
- –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é: —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥ –ø–æ–≤—Ç–æ—Ä–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏; –∂—ë—Å—Ç–∫–∏–π TTL.
- –õ–∏–º–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–∞ payload.

## –ê—É–¥–∏—Ç –ª–æ–≥–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–∏–º—ã–µ –±–∏–∑–Ω–µ—Å-–¥–µ–π—Å—Ç–≤–∏—è: —Å–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–æ–≤, –∑–∞–ø—É—Å–∫ refund/cancel, –∞–¥–º–∏–Ω-–≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞.
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å `who`, `what`, `when`, `correlation_id`, `order_id`.
- –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∞—É–¥–∏—Ç–æ–≤ (WORM/SIEM) –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

## –ú–æ–¥–µ–ª—å —É–≥—Ä–æ–∑ (–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)
- MITM –∏–ª–∏ –ø–æ–¥–º–µ–Ω–∞ –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ ‚Üí mTLS, NetworkPolicy, —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏.
- ¬´–î–≤–æ–π–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç¬ª (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π refund/confirm) ‚Üí –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ —à–∞–≥–∏, –∫–ª—é—á–∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏, reconcile-–ø–æ—Ç–æ–∫–∏.
- DoS —á–µ—Ä–µ–∑ –º–∞—Å—Å–æ–≤—ã–µ –º—É—Ç–∞—Ü–∏–∏ ‚Üí rate limiting, circuit breaker.
- –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ ‚Üí secret manager, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–ø—Ä–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- –ò–Ω—ä–µ–∫—Ü–∏–∏/–ø—Ä–æ–±–µ–ª—ã –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ‚Üí —Å—Ç—Ä–æ–≥–∏–µ —Å—Ö–µ–º—ã, –ø—Ä–æ–≤–µ—Ä–∫–∏, –ª–∏–º–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–≤.
- –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π ‚Üí RBAC, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π, –∞—É–¥–∏—Ç –∞–¥–º–∏–Ω-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

## –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –ü–î–Ω (PII)
- –í `orders` —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ `customer_id`; –∏–∑–±–µ–≥–∞—Ç—å –ü–î–Ω –≤ —è–¥—Ä–µ.
- –ú–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å –ü–î–Ω –≤ –ª–æ–≥–∞—Ö/—Ç—Ä–µ–π—Å–∞—Ö; —à–∏—Ñ—Ä–æ–≤–∞—Ç—å ¬´–Ω–∞ –ø–æ–∫–æ–µ¬ª –ø—Ä–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –ø–æ–ª–∏—Ç–∏–∫–∏.

## –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–ª–µ—Ä—Ç—ã
- –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ authn/z, —Ç—Ä–µ–Ω–¥—ã 401/403.
- –°—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è rate limit; –∞–Ω–æ–º–∞–ª–∏–∏ –ø–æ –∫–ª–∏–µ–Ω—Ç—É/IP.
- –ê–Ω–æ–º–∞–ª–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ–∫—Ä–µ—Ç–∞–º –ø–æ –∂—É—Ä–Ω–∞–ª–∞–º —Å–µ–∫—Ä–µ—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞.

